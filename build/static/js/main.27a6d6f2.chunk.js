(this.webpackJsonppr_image=this.webpackJsonppr_image||[]).push([[0],{40:function(e,t,a){},42:function(e,t,a){},45:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(29),r=a.n(c),i=a(9),o=(a(40),a(11)),l=a(12),u=a(14),d=a(13),j=(a(41),a(42),a(3)),m=a(18),h=a(2),p=a.n(h),b=(a(45),a(0)),f=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).baseUrl="https://localhost:3000",n.onChange=function(e){n.setState(Object(m.a)({},e.target.name,e.target.value))},n.onSubmit=function(e){e.preventDefault();var t=n.state;t.username,t.password;fetch(n.baseUrl+"/login",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(n.state)}).then((function(e){return e.json()})).then((function(e){console.log(e),e.accessToken?(n.setState({jwt:e.accessToken}),sessionStorage.setItem("token",e.accessToken),window.location.reload(!1)):alert("Invalid credentials")}))},n.state={username:"",password:"",jwt:sessionStorage.getItem("token")||null},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"parent-login",children:this.state.jwt?Object(b.jsx)(j.a,{to:"/gallery"}):Object(b.jsxs)("div",{className:"login-form",children:[Object(b.jsxs)("form",{className:"form-login",onSubmit:this.onSubmit,children:[Object(b.jsx)("h3",{className:"h3 mb-3 font-weight-normal text-center",children:"Login"}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Email"}),Object(b.jsx)("input",{className:"form-control",placeholder:"Enter username",name:"username",required:!0,onChange:function(t){return e.onChange(t)}}),"            "]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",name:"password",required:!0,onChange:function(t){return e.onChange(t)}}),"            "]}),Object(b.jsx)("button",{type:"submit",className:"btn btn-block btn-primary",children:"Login"})]}),Object(b.jsx)("br",{})]})})}}]),a}(n.Component);f.contextTypes={router:p.a.object};var g=a(15),x=a(5),v=a.n(x),O=a(27),N=a(31),k=a(34),w=a(32),y=a.n(w),I=(a(69),a(70),a(71),a(72),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).baseUrl="https://localhost:3000",n.fileObj=[],n.fileArray=[],n.allowedExtensions=["jpg","png","svg"],n.uploadImages=[],n.afterUploadMessage="NOTE: Images of size less than 500 would be rejected !!!",n.validateFiles=function(){var e=Object(k.a)(v.a.mark((function e(t){var a,n,s=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=v.a.mark((function e(a){var n,c,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.item(a).name.split("."))[0]){e.next=10;break}return c=new Image,r=URL.createObjectURL(t.item(a)),c.src=r,e.next=7,Object(N.a)(new Promise((function(e){c.onload=function(){Math.min(c.width,c.height)>=500?e({file:t.item(a),name:n[0],description:"",url:r}):(e(void 0),s.afterUploadMessage="Some images are less than 500px. Ignoring them !!")}})));case 7:return i=e.sent,e.next=10,i;case 10:case"end":return e.stop()}}),e)})),n=0;case 2:if(!(n<t.length)){e.next=7;break}return e.delegateYield(a(n),"t0",4);case 4:n++,e.next=2;break;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClick=function(e){n.inputElement.click()},n.filesButton=function(){var e=Object(g.a)(v.a.mark((function e(t){var a,s,c,r,i,o,l,u,d;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.afterUploadMessage="NOTE: Images of size less than 500 would be rejected !!!",a=t.target.files,s=n.validateFiles(a),c=!0,r=!1,e.prev=5,o=Object(O.a)(s);case 7:return e.next=9,o.next();case 9:return l=e.sent,c=l.done,e.next=13,l.value;case 13:if(u=e.sent,c){e.next=20;break}void 0!==(d=u)&&n.uploadImages.push(d);case 17:c=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),r=!0,i=e.t0;case 26:if(e.prev=26,e.prev=27,c||null==o.return){e.next=31;break}return e.next=31,o.return();case 31:if(e.prev=31,!r){e.next=34;break}throw i;case 34:return e.finish(31);case 35:return e.finish(26);case 36:n.setState({image:n.uploadImages}),console.log(n.state);case 38:case"end":return e.stop()}}),e,null,[[5,22,26,36],[27,,31,35]])})));return function(t){return e.apply(this,arguments)}}(),n.uploadImagesFunc=function(){var e=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],n.setState({uploading:!0}),e.next=4,Promise.all(t.map(function(){var e=Object(g.a)(v.a.mark((function e(t){var s,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=new FormData).append("file",t.file),s.append("name",t.name),s.append("description",t.description),console.log("sending form data"),e.next=7,fetch(n.baseUrl+"/upload",{method:"POST",body:s});case 7:c=e.sent,a.push(c.status);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return n.setState({uploading:!1}),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.dragOver=function(e){e.preventDefault()},n.dragEnter=function(e){e.preventDefault()},n.dragLeave=function(e){e.preventDefault()},n.fileDrop=function(){var e=Object(g.a)(v.a.mark((function e(t){var a,s,c,r,i,o,l,u,d;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=t.dataTransfer.files,s=n.validateFiles(a),c=!0,r=!1,e.prev=5,o=Object(O.a)(s);case 7:return e.next=9,o.next();case 9:return l=e.sent,c=l.done,e.next=13,l.value;case 13:if(u=e.sent,c){e.next=20;break}void 0!==(d=u)&&n.uploadImages.push(d);case 17:c=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),r=!0,i=e.t0;case 26:if(e.prev=26,e.prev=27,c||null==o.return){e.next=31;break}return e.next=31,o.return();case 31:if(e.prev=31,!r){e.next=34;break}throw i;case 34:return e.finish(31);case 35:return e.finish(26);case 36:n.setState({image:n.uploadImages});case 37:case"end":return e.stop()}}),e,null,[[5,22,26,36],[27,,31,35]])})));return function(t){return e.apply(this,arguments)}}(),n.state={image:[],uploading:!1},n}return Object(l.a)(a,[{key:"checkValidName",value:function(){var e=!0;return this.uploadImages.forEach((function(t){if(!t.name)return e=!1})),e}},{key:"uploadClick",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,0!=this.uploadImages.length){e.next=3;break}return e.abrupt("return");case 3:if(this.checkValidName){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.uploadImagesFunc(this.state.image);case 7:e.sent.forEach((function(e){200!==e&&(t=!1)})),this.afterUploadMessage=t?"Images uploaded successfully":"Failed to upload one or more images !!",this.uploadImages=[],this.setState({image:this.uploadImages});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)("h1",{children:" UPLOAD FILES"}),Object(b.jsx)("div",{className:"button-container",style:{display:"none"},children:Object(b.jsx)("div",{className:"hover",children:Object(b.jsxs)("div",{className:"fileUpload btns btn-secondary",children:[Object(b.jsx)("a",{className:"social-link",onClick:this.handleClick,children:Object(b.jsx)("i",{className:"fa fa-image"})}),Object(b.jsx)("input",{className:"upload",id:"files",name:"files",type:"file",accept:"image/*",multiple:!0,onChange:function(t){return e.filesButton(t)},ref:function(t){return e.inputElement=t}})]})})}),Object(b.jsx)("div",{className:"DZcontainer",onClick:this.handleClick,children:Object(b.jsx)("div",{className:"drop-container",onDragOver:this.dragOver,onDragEnter:this.dragEnter,onDragLeave:this.dragLeave,onDrop:this.fileDrop,children:Object(b.jsxs)("div",{className:"drop-message",children:[Object(b.jsx)("div",{className:"upload-icon"}),"Drag & Drop files here or click to upload"]})})}),Object(b.jsx)("div",{className:"alert-message-container",children:Object(b.jsx)("span",{className:"alert-message",children:this.afterUploadMessage})}),this.state.uploading?Object(b.jsx)(y.a,{className:"loader",type:"Puff",color:"#00BFFF",height:50,width:50}):Object(b.jsx)("div",{className:"upload-container",children:Object(b.jsx)("div",{className:"vertical-center",children:Object(b.jsx)("button",{className:"btn draw-border",onClick:function(){return e.uploadClick()},children:"Upload"})})}),Object(b.jsx)("div",{className:"image-view",children:Object(b.jsx)("ul",{className:"cards",children:(this.uploadImages||[]).map((function(t,a){return Object(b.jsx)("li",{className:"cards__item",children:Object(b.jsxs)("div",{className:"card",children:[Object(b.jsx)("div",{className:"card__image ",style:{backgroundImage:"url(".concat(t.url,")")}}),Object(b.jsxs)("div",{className:"card__content",children:[Object(b.jsx)("div",{className:"card__title",children:Object(b.jsx)("input",{id:"name".concat(a),name:"name{i}",type:"text",defaultValue:t.name,onChange:function(t){e.state.image[a].name=t.target.value,e.forceUpdate()}})}),0===t.name.length?Object(b.jsx)("span",{className:"warning-text",children:"Image name empty"}):null,Object(b.jsx)("div",{className:"card__title",children:Object(b.jsx)("input",{id:"description".concat(a),name:"description{i}",type:"text",placeholder:"#description ",onChange:function(t){e.state.image[a].description=t.target.value,e.forceUpdate()}})})]})]})},a)}))})})]})}}]),a}(n.Component)),S=a(17),C=a(22),_=a(33);a(73);function E(){var e="https://localhost:3000",t=s.a.useState([]),a=Object(C.a)(t,2),n=a[0],c=a[1],r=s.a.useState(!1),i=Object(C.a)(r,2),o=i[0],l=i[1],u=s.a.useState(1),d=Object(C.a)(u,2),j=d[0],m=d[1],h=function(){fetch("".concat(e,"/search?query=_page:").concat(j),{method:"GET"}).then((function(e){e.json().then((function(e){c([].concat(Object(S.a)(n),Object(S.a)(e.message))),l(!0),m(j+1)}))}))};s.a.useEffect((function(){h()}),[]);return Object(b.jsx)("div",{className:"parentElement",children:Object(b.jsx)("div",{className:"image-view",children:Object(b.jsx)(_.a,{dataLength:n,next:function(){h()},hasMore:!0,endMessage:Object(b.jsx)("p",{style:{textAlign:"center"},children:Object(b.jsx)("b",{children:"Yay! You have seen it all"})}),children:Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("ul",{className:"cards",children:o?(n||[]).map((function(t,a){return Object(b.jsx)("li",{className:"cards__item",children:Object(b.jsxs)("div",{className:"card",children:[Object(b.jsx)("div",{className:"card__image ",style:{backgroundImage:"url(".concat(e,"/").concat(t.file240,")")}}),Object(b.jsxs)("div",{className:"card__content",children:[Object(b.jsx)("div",{className:"card__title",children:Object(b.jsx)("span",{id:"name".concat(a),children:t.name})}),Object(b.jsxs)("p",{className:"card__text",id:"cardText".concat(a),children:[Object(b.jsx)("span",{className:"date",children:t.createdAt}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),Object(b.jsx)("span",{className:"hashtag",children:t.description})]})]}),Object(b.jsx)("i",{className:"fa fa-trash","aria-hidden":"true",onClick:function(){return function(t,a){console.log(t),fetch("".concat(e,"/delete/").concat(t),{method:"POST"}).then((function(e){e.json().then((function(e){console.log(e);var t=Object(S.a)(n);t.splice(a,1),c(Object(S.a)(t))}))})).catch((function(e){console.log(e.json()),alert("Failed to delete image")}))}(t.id,a)}})]})},a)})):""})})})})})}var D=a(21),U=a(35),F=function(e){var t=e.component,a=e.loggedIn,n=Object(U.a)(e,["component","loggedIn"]);return Object(b.jsx)(j.b,Object(D.a)(Object(D.a)({},n),{},{render:function(e){return a?Object(b.jsx)(t,Object(D.a)({},e)):Object(b.jsx)(j.a,{to:{pathname:"/",state:{prevLocation:"/",error:"You must log in first !!"}}})}}))},L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={loggedIn:!!sessionStorage.getItem("token"),error:sessionStorage.getItem("token")?"":"You must log in first"},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state.error.error;return Object(b.jsx)(i.a,{children:Object(b.jsxs)("div",{className:"App",children:[Object(b.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:[Object(b.jsx)(i.b,{className:"navbar-brand",to:"/gallery",children:"ImageStack"}),Object(b.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[Object(b.jsx)("ul",{className:"navbar-nav mr-auto",children:Object(b.jsx)("li",{className:"nav-item active"})}),Object(b.jsxs)("ul",{className:"navbar-nav ",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(i.b,{className:"nav-link",to:"/gallery",children:"Gallery"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(i.b,{className:"nav-link",to:"/upload-images",children:"Upload"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(i.b,{className:"nav-link",to:"/",onClick:function(){sessionStorage.clear(),window.location.reload()},children:"Logout"})})]})]})]}),Object(b.jsxs)("div",{className:"outer",children:[e&&alert({error:e}),Object(b.jsxs)(j.d,{children:[Object(b.jsx)(j.b,{exact:!0,path:"/",component:f}),Object(b.jsx)(j.b,{path:"/sign-in",component:f}),Object(b.jsx)(F,{path:"/upload-images",loggedIn:this.state.loggedIn,component:I}),Object(b.jsx)(F,{path:"/gallery",loggedIn:this.state.loggedIn,component:E}),Object(b.jsx)(F,{path:"/",loggedIn:this.state.loggedIn,component:E})]})]})]})})}}]),a}(s.a.Component),T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,75)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(b.jsx)(i.a,{children:Object(b.jsx)(L,{})}),document.getElementById("root")),T()}},[[74,1,2]]]);
//# sourceMappingURL=main.27a6d6f2.chunk.js.map