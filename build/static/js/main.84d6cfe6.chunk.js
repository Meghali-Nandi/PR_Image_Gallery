(this.webpackJsonppr_image=this.webpackJsonppr_image||[]).push([[0],{41:function(e,t,a){},43:function(e,t,a){},54:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(30),r=a.n(c),i=a(9),o=(a(41),a(12)),l=a(13),u=a(15),d=a(14),j=(a(42),a(43),a(3)),m=a(19),h=a(10),p=(a(54),a(0)),b=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).baseUrl="https://localhost:8080",n.onChange=function(e){n.setState(Object(m.a)({},e.target.name,e.target.value))},n.onSubmit=function(e){e.preventDefault();var t=n.state;t.username,t.password;fetch(n.baseUrl+"/login",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(n.state)}).then((function(e){return e.json()})).then((function(e){e.accessToken?(n.setState({jwt:e.accessToken}),sessionStorage.setItem("token",e.accessToken),window.location.reload(!1)):h.ToastsStore.error("Invalid credentials. Please enter correct credentials.")}))},n.state={username:"",password:"",jwt:sessionStorage.getItem("token")||null},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(p.jsxs)("div",{className:"parent-login",children:[Object(p.jsx)(h.ToastsContainer,{className:"toast",store:h.ToastsStore}),this.state.jwt?Object(p.jsx)(j.a,{to:"/gallery"}):Object(p.jsxs)("div",{className:"login-form",children:[Object(p.jsxs)("form",{className:"form-login",onSubmit:this.onSubmit,children:[Object(p.jsx)("h3",{className:"h3 mb-3 font-weight-normal text-center",children:"Login"}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Email"}),Object(p.jsx)("input",{className:"form-control",placeholder:"Enter username",name:"username",required:!0,onChange:function(t){return e.onChange(t)}}),"            "]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Password"}),Object(p.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",name:"password",required:!0,onChange:function(t){return e.onChange(t)}}),"            "]}),Object(p.jsx)("button",{type:"submit",className:"btn btn-block btn-primary",children:"Login"})]}),Object(p.jsx)("br",{})]})]})}}]),a}(n.Component),f=a(16),g=a(5),x=a.n(g),v=a(28),O=a(32),N=a(35),k=a(33),w=a.n(k),y=(a(80),a(81),a(82),a(83),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).baseUrl="https://localhost:8080",n.fileObj=[],n.fileArray=[],n.allowedExtensions=["jpg","png","svg"],n.uploadImages=[],n.afterUploadMessage="NOTE: Images of size less than 500 would be rejected !!!",n.validateFiles=function(){var e=Object(N.a)(x.a.mark((function e(t){var a,n,s=this;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=x.a.mark((function e(a){var n,c,r,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.item(a).name.split("."))[0]){e.next=10;break}return c=new Image,r=URL.createObjectURL(t.item(a)),c.src=r,e.next=7,Object(O.a)(new Promise((function(e){c.onload=function(){Math.min(c.width,c.height)>=500?e({file:t.item(a),name:n[0],description:"",url:r}):(e(void 0),s.afterUploadMessage="Some images are less than 500px. Ignoring them !!")}})));case 7:return i=e.sent,e.next=10,i;case 10:case"end":return e.stop()}}),e)})),n=0;case 2:if(!(n<t.length)){e.next=7;break}return e.delegateYield(a(n),"t0",4);case 4:n++,e.next=2;break;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClick=function(e){n.inputElement.click()},n.filesButton=function(){var e=Object(f.a)(x.a.mark((function e(t){var a,s,c,r,i,o,l,u,d;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.afterUploadMessage="NOTE: Images of size less than 500 would be rejected !!!",a=t.target.files,s=n.validateFiles(a),c=!0,r=!1,e.prev=5,o=Object(v.a)(s);case 7:return e.next=9,o.next();case 9:return l=e.sent,c=l.done,e.next=13,l.value;case 13:if(u=e.sent,c){e.next=20;break}void 0!==(d=u)&&n.uploadImages.push(d);case 17:c=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),r=!0,i=e.t0;case 26:if(e.prev=26,e.prev=27,c||null==o.return){e.next=31;break}return e.next=31,o.return();case 31:if(e.prev=31,!r){e.next=34;break}throw i;case 34:return e.finish(31);case 35:return e.finish(26);case 36:n.setState({image:n.uploadImages});case 37:case"end":return e.stop()}}),e,null,[[5,22,26,36],[27,,31,35]])})));return function(t){return e.apply(this,arguments)}}(),n.uploadImagesFunc=function(){var e=Object(f.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],n.setState({uploading:!0}),e.next=4,Promise.all(t.map(function(){var e=Object(f.a)(x.a.mark((function e(t){var s,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=new FormData).append("file",t.file),s.append("name",t.name),s.append("description",t.description),e.next=6,fetch(n.baseUrl+"/upload",{method:"POST",body:s});case 6:c=e.sent,a.push(c.status);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return n.setState({uploading:!1}),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.dragOver=function(e){e.preventDefault()},n.dragEnter=function(e){e.preventDefault()},n.dragLeave=function(e){e.preventDefault()},n.fileDrop=function(){var e=Object(f.a)(x.a.mark((function e(t){var a,s,c,r,i,o,l,u,d;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=t.dataTransfer.files,s=n.validateFiles(a),c=!0,r=!1,e.prev=5,o=Object(v.a)(s);case 7:return e.next=9,o.next();case 9:return l=e.sent,c=l.done,e.next=13,l.value;case 13:if(u=e.sent,c){e.next=20;break}void 0!==(d=u)&&n.uploadImages.push(d);case 17:c=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),r=!0,i=e.t0;case 26:if(e.prev=26,e.prev=27,c||null==o.return){e.next=31;break}return e.next=31,o.return();case 31:if(e.prev=31,!r){e.next=34;break}throw i;case 34:return e.finish(31);case 35:return e.finish(26);case 36:n.setState({image:n.uploadImages});case 37:case"end":return e.stop()}}),e,null,[[5,22,26,36],[27,,31,35]])})));return function(t){return e.apply(this,arguments)}}(),n.state={image:[],uploading:!1},n}return Object(l.a)(a,[{key:"checkValidName",value:function(){var e=!0;return this.uploadImages.forEach((function(t){if(!t.name)return e=!1})),e}},{key:"uploadClick",value:function(){var e=Object(f.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,0!=this.uploadImages.length){e.next=3;break}return e.abrupt("return");case 3:if(this.checkValidName){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.uploadImagesFunc(this.state.image);case 7:e.sent.forEach((function(e){200!==e&&(t=!1)})),this.afterUploadMessage=t?"Images uploaded successfully":"Failed to upload one or more images !!",this.uploadImages=[],this.setState({image:this.uploadImages});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("h1",{children:" UPLOAD FILES"}),Object(p.jsx)("div",{className:"button-container",style:{display:"none"},children:Object(p.jsx)("div",{className:"hover",children:Object(p.jsxs)("div",{className:"fileUpload btns btn-secondary",children:[Object(p.jsx)("a",{className:"social-link",onClick:this.handleClick,children:Object(p.jsx)("i",{className:"fa fa-image"})}),Object(p.jsx)("input",{className:"upload",id:"files",name:"files",type:"file",accept:"image/*",multiple:!0,onChange:function(t){return e.filesButton(t)},ref:function(t){return e.inputElement=t}})]})})}),Object(p.jsx)("div",{className:"DZcontainer",onClick:this.handleClick,children:Object(p.jsx)("div",{className:"drop-container",onDragOver:this.dragOver,onDragEnter:this.dragEnter,onDragLeave:this.dragLeave,onDrop:this.fileDrop,children:Object(p.jsxs)("div",{className:"drop-message",children:[Object(p.jsx)("div",{className:"upload-icon"}),"Drag & Drop files here or click to upload"]})})}),Object(p.jsx)("div",{className:"alert-message-container",children:Object(p.jsx)("span",{className:"alert-message",children:this.afterUploadMessage})}),this.state.uploading?Object(p.jsx)(w.a,{className:"loader",type:"Puff",color:"#00BFFF",height:50,width:50}):Object(p.jsx)("div",{className:"upload-container",children:Object(p.jsx)("div",{className:"vertical-center",children:Object(p.jsx)("button",{className:"btn draw-border",onClick:function(){return e.uploadClick()},children:"Upload"})})}),Object(p.jsx)("div",{className:"image-view",children:Object(p.jsx)("ul",{className:"cards",children:(this.uploadImages||[]).map((function(t,a){return Object(p.jsx)("li",{className:"cards__item",children:Object(p.jsxs)("div",{className:"card",children:[Object(p.jsx)("div",{className:"card__image ",style:{backgroundImage:"url(".concat(t.url,")")}}),Object(p.jsxs)("div",{className:"card__content",children:[Object(p.jsx)("div",{className:"card__title",children:Object(p.jsx)("input",{id:"name".concat(a),name:"name{i}",type:"text",defaultValue:t.name,onChange:function(t){e.state.image[a].name=t.target.value,e.forceUpdate()}})}),0===t.name.length?Object(p.jsx)("span",{className:"warning-text",children:"Image name empty"}):null,Object(p.jsx)("div",{className:"card__title",children:Object(p.jsx)("input",{id:"description".concat(a),name:"description{i}",type:"text",placeholder:"#description ",onChange:function(t){e.state.image[a].description=t.target.value,e.forceUpdate()}})})]})]})},a)}))})})]})}}]),a}(n.Component)),I=a(18),S=a(23),C=a(34);a(84);function _(){var e=this,t="https://localhost:8080",a=s.a.useState([]),n=Object(S.a)(a,2),c=n[0],r=n[1],i=s.a.useState(!1),o=Object(S.a)(i,2),l=o[0],u=o[1],d=s.a.useState(1),j=Object(S.a)(d,2),m=j[0],b=j[1],f=function(){fetch("".concat(t,"/search?query=_page:").concat(m),{method:"GET"}).then((function(e){e.json().then((function(e){r([].concat(Object(I.a)(c),Object(I.a)(e.message))),u(!0),b(m+1)}))}))};s.a.useEffect((function(){f()}),[]);return window.onscroll=function(t){console.log(e.oldScroll>e.scrollY),e.oldScroll=e.scrollY},Object(p.jsxs)("div",{className:"parentElement",children:[Object(p.jsx)(h.ToastsContainer,{className:"toast",store:h.ToastsStore}),Object(p.jsx)("div",{className:"image-view",children:Object(p.jsx)(C.a,{dataLength:c,next:function(){f()},hasMore:!0,children:Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("ul",{className:"cards",children:l?(c||[]).map((function(e,a){return Object(p.jsx)("li",{className:"cards__item",children:Object(p.jsxs)("div",{className:"card",children:[Object(p.jsx)("div",{className:"card__image ",style:{backgroundImage:"url(".concat(t,"/").concat(e.file240,")")}}),Object(p.jsxs)("div",{className:"card__content",children:[Object(p.jsx)("div",{className:"card__title",children:Object(p.jsx)("span",{id:"name".concat(a),children:e.name})}),Object(p.jsxs)("p",{className:"card__text",id:"cardText".concat(a),children:[Object(p.jsx)("span",{className:"date",children:e.createdAt}),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),Object(p.jsx)("span",{className:"hashtag",children:e.description})]})]}),Object(p.jsx)("i",{className:"fa fa-trash","aria-hidden":"true",onClick:function(){return function(e,a,n){fetch("".concat(t,"/delete/").concat(e),{method:"POST"}).then((function(e){e.json().then((function(e){var t=Object(I.a)(c);t.splice(a,1),r(Object(I.a)(t)),h.ToastsStore.success("Image ".concat(n," deleted successfully"))}))})).catch((function(e){console.log(e.json()),alert("Failed to delete image")}))}(e.id,a,e.name)}})]})},a)})):""})})})})]})}var T=a(22),E=a(36),D=function(e){var t=e.component,a=e.loggedIn,n=Object(E.a)(e,["component","loggedIn"]);return Object(p.jsx)(j.b,Object(T.a)(Object(T.a)({},n),{},{render:function(e){return a?Object(p.jsx)(t,Object(T.a)({},e)):Object(p.jsx)(j.a,{to:{pathname:"/",state:{prevLocation:"/",error:"You must log in first !!"}}})}}))},U=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={loggedIn:!!sessionStorage.getItem("token"),error:sessionStorage.getItem("token")?"":"You must log in first"},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state.error.error;return Object(p.jsx)(i.a,{children:Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:[Object(p.jsx)(i.b,{className:"navbar-brand",to:"/gallery",children:"ImageStack"}),Object(p.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[Object(p.jsx)("ul",{className:"navbar-nav mr-auto",children:Object(p.jsx)("li",{className:"nav-item active"})}),Object(p.jsxs)("ul",{className:"navbar-nav ",children:[Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(i.b,{className:"nav-link",to:"/gallery",children:"Gallery"})}),Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(i.b,{className:"nav-link",to:"/upload-images",children:"Upload"})}),Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(i.b,{className:"nav-link",to:"/",onClick:function(){sessionStorage.clear(),window.location.reload()},children:"Logout"})})]})]})]}),Object(p.jsxs)("div",{className:"outer",children:[e&&alert({error:e}),Object(p.jsxs)(j.d,{children:[Object(p.jsx)(j.b,{exact:!0,path:"/",component:b}),Object(p.jsx)(j.b,{path:"/sign-in",component:b}),Object(p.jsx)(D,{path:"/upload-images",loggedIn:this.state.loggedIn,component:y}),Object(p.jsx)(D,{path:"/gallery",loggedIn:this.state.loggedIn,component:_}),Object(p.jsx)(D,{path:"/",loggedIn:this.state.loggedIn,component:_})]})]})]})})}}]),a}(s.a.Component),F=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,86)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(p.jsx)(i.a,{children:Object(p.jsx)(U,{})}),document.getElementById("root")),F()}},[[85,1,2]]]);
//# sourceMappingURL=main.84d6cfe6.chunk.js.map